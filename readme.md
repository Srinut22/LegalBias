This project compares three methods for evaluating ECHR (European Court of Human Rights) article violations:
1. **Direct Eval**: LLM-based direct evaluation using Qwen1.5-7B
2. **Prolog**: Rule-based evaluation using standard Prolog
3. **ProbLog**: Probabilistic evaluation using ProbLog

## Project Structure

### Core Scripts
- `generateProlog.py` - Generates Prolog and ProbLog case files from case summaries
- `directEval.py` - Performs direct LLM evaluation on case summaries
- `evaluate_problog_vs_prolog.py` - Evaluates Prolog and ProbLog cases against ECHR ground truth
- `analyze_all_results.py` - Comprehensive analysis: compares all methods, analyzes protected variables, and computes metric variation

### Data Directories
- `Prolog/` - Standard Prolog case files (654 cases)
- `ProbLog/` - Probabilistic Prolog case files (654 cases)
- `Summary/` - Case summaries (used by generateProlog.py and directEval.py)
- `ECHR/` - ECHR article definitions and Prolog rules
  - `echr_articles/` - Article text definitions
  - `echr_prolog/` - Prolog rule files (article2.pl, article3.pl, article6.pl)

### Results
- `results_strict_direct_eval.jsonl` - Direct evaluation results
- `comparison_results.json` - Prolog/ProbLog evaluation results
- `all_methods_comparison.json` - Overall comparison metrics (generated by analyze_all_results.py)
- `protected_variables_analysis.json` - Metrics broken down by protected variables (generated by analyze_all_results.py)
- `metric_variation_analysis.json` - Variation analysis across protected attributes (generated by analyze_all_results.py)
- `plots/` - Generated visualization plots

### Analysis
- `Analysis/analyzeResults.ipynb` - Jupyter notebook for result analysis

## Evaluation

The project evaluates violations for **Articles 2, 3, and 6** of the ECHR:
- **Article 2**: Right to life
- **Article 3**: Prohibition of torture
- **Article 6**: Right to a fair trial

All methods are evaluated against the ECtHR test dataset from Hugging Face (`coastalcph/fairlex`).

## Usage

1. Generate Prolog/ProbLog cases:
   ```bash
   python generateProlog.py
   ```

2. Run direct evaluation:
   ```bash
   python directEval.py
   ```

3. Evaluate Prolog/ProbLog:
   ```bash
   python evaluate_problog_vs_prolog.py
   ```

4. Run comprehensive analysis (compares methods, analyzes protected variables, computes variation):
   ```bash
   python analyze_all_results.py
   ```

## Requirements

See `requirements.txt` for dependencies.
